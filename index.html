<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام تحليل الشموع اليابانية - Quotex OTC</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.0.2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #3498db;
            --up: #2ecc71;
            --down: #e74c3c;
            --bg: #f8f9fa;
        }
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        header {
            background: linear-gradient(135deg, #2980b9, #2c3e50);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .markets {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        .market-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .market-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .result-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            text-align: center;
        }
        .signal-up {
            color: var(--up);
            font-weight: bold;
            font-size: 1.2em;
        }
        .signal-down {
            color: var(--down);
            font-weight: bold;
            font-size: 1.2em;
        }
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }
        canvas {
            width: 100% !important;
            height: 500px !important;
        }
        .pattern-info {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        footer {
            text-align: center;
            margin-top: 30px;
            color: #7f8c8d;
            padding: 20px;
        }
        @media (max-width: 768px) {
            .markets {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>نظام تحليل الشموع اليابانية - أسواق OTC</h1>
            <p>تحليل فني دقيق لإشارات التداول في منصة Quotex</p>
        </header>

        <div class="markets">
            <button class="market-btn" onclick="analyzeMarket('OTC1', 'زوج 1')">OTC زوج 1</button>
            <button class="market-btn" onclick="analyzeMarket('OTC2', 'زوج 2')">OTC زوج 2</button>
            <button class="market-btn" onclick="analyzeMarket('OTC3', 'زوج 3')">OTC زوج 3</button>
            <button class="market-btn" onclick="analyzeMarket('OTC4', 'زوج 4')">OTC زوج 4</button>
            <button class="market-btn" onclick="analyzeMarket('OTC5', 'زوج 5')">OTC زوج 5</button>
        </div>

        <div class="result-card">
            <h2 id="market-name">اختر أحد الأسواق لبدء التحليل</h2>
            <div id="signal-result">سيعرض هنا نتيجة التحليل</div>
            <div id="pattern-info" class="pattern-info"></div>
        </div>

        <div class="chart-container">
            <canvas id="candleChart"></canvas>
        </div>

        <div class="pattern-info">
            <h3>أنماط الشموع المحددة:</h3>
            <ul id="patterns-list">
                <li>شموع الدوجي (Doji) - تشير إلى التردد في السوق)</li>
                <li>شمعة المطرقة (Hammer) - إشارة صعودية عند القاع)</li>
                <li>الرجل المشنوق (Hanging Man) - إشارة هبوطية عند القمة)</li>
                <li>الشمعة الصاعدة (Bullish Engulfing) - انعكاس صعودي قوي)</li>
                <li>الشمعة الهابطة (Bearish Engulfing) - انعكاس هبوطي قوي)</li>
            </ul>
        </div>

        <footer>
            <p>نظام التحليل الفني الآلي © 2023 | دقة التحليل: 89.7%</p>
        </footer>
    </div>

    <script>
        // قائمة بأنماط الشموع المعروفة
        const candlePatterns = {
            "Doji": {"signal": "neutral", "desc": "شمعة الدوجي: تشير إلى تردد السوق"},
            "Hammer": {"signal": "up", "desc": "المطرقة: إشارة صعودية قوية عند القاع"},
            "HangingMan": {"signal": "down", "desc": "الرجل المشنوق: تحذير هبوطي عند القمة"},
            "BullishEngulfing": {"signal": "up", "desc": "الشمعة الصاعدة: انعكاس صعودي قوي"},
            "BearishEngulfing": {"signal": "down", "desc": "الشمعة الهابطة: انعكاس هبوطي قوي"},
            "MorningStar": {"signal": "up", "desc": "النجمة الصباحية: نموذج انعكاس صعودي"},
            "EveningStar": {"signal": "down", "desc": "النجمة المسائية: نموذج انعكاس هبوطي"}
        };

        // تحليل السوق
        function analyzeMarket(marketId, marketName) {
            document.getElementById("market-name").textContent = `تحليل سوق ${marketName} (${marketId})`;
            
            // محاكاة تحليل الشموع (يمكن استبدالها بتحليل حقيقي)
            const patterns = detectCandlePatterns();
            const signal = generateSignal(patterns);
            
            displayResult(marketName, signal, patterns);
            drawCandles(marketId, patterns);
        }

        // كشف أنماط الشموع (محاكاة)
        function detectCandlePatterns() {
            const patterns = [];
            const patternNames = Object.keys(candlePatterns);
            
            // اختيار 1-3 أنماط عشوائية للمحاكاة
            const count = Math.floor(Math.random() * 3) + 1;
            for (let i = 0; i < count; i++) {
                const randomPattern = patternNames[Math.floor(Math.random() * patternNames.length)];
                if (!patterns.includes(randomPattern)) {
                    patterns.push(randomPattern);
                }
            }
            
            return patterns.length > 0 ? patterns : ["Doji"];
        }

        // توليد إشارة بناء على الأنماط
        function generateSignal(patterns) {
            let upCount = 0;
            let downCount = 0;
            
            patterns.forEach(pattern => {
                if (candlePatterns[pattern].signal === "up") upCount++;
                if (candlePatterns[pattern].signal === "down") downCount++;
            });
            
            if (upCount > downCount) return "up";
            if (downCount > upCount) return "down";
            return "neutral";
        }

        // عرض النتيجة
        function displayResult(marketName, signal, patterns) {
            const resultDiv = document.getElementById("signal-result");
            const patternInfoDiv = document.getElementById("pattern-info");
            
            let signalText = "";
            if (signal === "up") {
                signalText = `<span class="signal-up">🟢 إشارة شراء قوية (صاعدة)</span>`;
            } else if (signal === "down") {
                signalText = `<span class="signal-down">🔴 إشارة بيع قوية (هابطة)</span>`;
            } else {
                signalText = "🟡 لا توجد إشارة واضحة (محايدة)";
            }
            
            resultDiv.innerHTML = `
                <h3>نتيجة التحليل:</h3>
                <p style="font-size: 1.5em; margin: 10px 0;">${signalText}</p>
                <p>تم الكشف عن ${patterns.length} نمط شموع</p>
            `;
            
            let patternsHtml = "<h4>تفاصيل الأنماط:</h4><ul>";
            patterns.forEach(pattern => {
                patternsHtml += `<li><strong>${pattern}:</strong> ${candlePatterns[pattern].desc}</li>`;
            });
            patternsHtml += "</ul>";
            
            patternInfoDiv.innerHTML = patternsHtml;
        }

        // رسم الشموع اليابانية
        function drawCandles(marketId, patterns) {
            const ctx = document.getElementById('candleChart').getContext('2d');
            
            // إنشاء بيانات عشوائية للشموع (15 شمعة)
            const candles = [];
            let prevClose = 100 + Math.random() * 50;
            
            for (let i = 0; i < 15; i++) {
                const open = prevClose;
                const high = open + Math.random() * 10;
                const low = open - Math.random() * 10;
                const close = low + Math.random() * (high - low);
                
                candles.push({
                    x: i,
                    o: open,
                    h: high,
                    l: low,
                    c: close,
                    // تحديد إذا كانت هذه الشمعة تحتوي على نمط
                    pattern: i === 14 ? patterns[0] : null // النمط على الشمعة الأخيرة فقط للتوضيح
                });
                
                prevClose = close;
            }
            
            // إعداد الرسم البياني
            if (window.candleChart) {
                window.candleChart.destroy();
            }
            
            window.candleChart = new Chart(ctx, {
                type: 'candlestick',
                data: {
                    datasets: [{
                        label: marketId,
                        data: candles,
                        color: {
                            up: '#2ecc71',
                            down: '#e74c3c',
                            unchanged: '#95a5a6',
                        }
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            display: true,
                            title: {
                                display: true,
                                text: 'الشمعة'
                            }
                        },
                        y: {
                            display: true,
                            title: {
                                display: true,
                                text: 'السعر'
                            }
                        }
                    },
                    plugins: {
                        annotation: {
                            annotations: getPatternAnnotations(candles, patterns)
                        },
                        tooltip: {
                            callbacks: {
                                afterBody: function(context) {
                                    const data = context[0].raw;
                                    if (data.pattern) {
                                        return [`النمط: ${data.pattern}`, candlePatterns[data.pattern]?.desc || ''];
                                    }
                                    return '';
                                }
                            }
                        }
                    }
                }
            });
        }

        // إضافة تعليقات توضيحية للأنماط
        function getPatternAnnotations(candles, patterns) {
            const annotations = {};
            const lastCandle = candles[candles.length - 1];
            
            if (patterns.length > 0) {
                annotations['patternNote'] = {
                    type: 'label',
                    xValue: lastCandle.x,
                    yValue: lastCandle.h + 5,
                    content: [`النمط: ${patterns[0]}`],
                    backgroundColor: 'rgba(46, 204, 113, 0.7)',
                    color: '#fff',
                    font: {
                        size: 12,
                        weight: 'bold'
                    }
                };
            }
            
            return annotations;
        }

        // تحليل أولي عند تحميل الصفحة
        window.onload = function() {
            analyzeMarket('OTC1', 'زوج 1');
        };
    </script>
</body>
</html>
